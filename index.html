<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Imagem Satélite - Meteosat (EUMETSAT WMS)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #eef2f7;
      margin: 0;
      padding: 20px;
    }
    h1 {
      margin-bottom: 10px;
    }
    #timestamp {
      font-size: 0.9em;
      color: #555;
      margin-bottom: 20px;
    }
    img {
      max-width: 95%;
      height: auto;
      border: 2px solid #333;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>
  <h1>Imagem Satélite - Meteosat (Visível)</h1>
  <p>Fonte: <a href="https://view.eumetsat.int/" target="_blank">EUMETSAT WMS</a></p>
  <div id="timestamp">A carregar...</div>
  <img id="satellite" alt="Imagem Satélite Meteosat">

  <script>
    const img = document.getElementById("satellite");
    const timestamp = document.getElementById("timestamp");

    function updateImage() {
      const now = new Date();
      const baseUrl = "https://view.eumetsat.int/geoserver/wms?";
      const params = new URLSearchParams({
        service: "WMS",
        version: "1.1.1",
        request: "GetMap",
        layers: "meteosat:msg_vis006",  // camada visível (0.6 µm)
        styles: "",
        format: "image/png",
        srs: "EPSG:4326",
        bbox: "-30,25,20,55", // Oeste-Europa (inclui Portugal)
        width: "800",
        height: "600",
        time: now.toISOString() // pede imagem mais recente possível
      });

      // força refresh ignorando cache
      img.src = baseUrl + params.toString() + "&nocache=" + now.getTime();
      timestamp.textContent = "Última atualização: " + now.toLocaleString("pt-PT");
    }

    // Atualiza imediatamente ao carregar
    updateImage();

    // Atualiza a cada 10 minutos
    setInterval(updateImage, 600000);
  </script>
</body>
</html>
